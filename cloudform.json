{
"AWSTemplateFormatVersion": "2010-09-09",
    "Description": "creating 1 vpc and 2 subnets in json",
    
    "Parameters": {
      "AZ": {
        "Description" : "list of existing Availability Zones in this region",
        "Type" : "AWS::EC2::AvailabilityZone::Name"
      }
    },
    
    "Resources": {
      "VPC": {
        "Type": "AWS::EC2::VPC",
        "Properties": {
          "CidrBlock": "10.5.0.0/16",
          "Tags":[
          { "Key": "Name", "Value":  "NEW-VPC" }
          ]
        }
      },
        
      "pubsubnet1": {
          "Type": "AWS::EC2::Subnet",
          "Properties": {
            "AvailabilityZone": 
            { "Ref": "AZ" }
            ,
            "VpcId": 
            { "Ref": "VPC" }
            ,
            "CidrBlock": "10.5.0.0/24",
            "Tags":[
            { "Key": "Name", "Value":  "pubsubnet1" }
            ]
          }
        },
      "pubsubnet2": {
        "Type": "AWS::EC2::Subnet",
        "Properties": {
          "AvailabilityZone": 
          { "Ref": "AZ" }
          ,
          "VpcId": 
          { "Ref": "VPC" }
          ,
          "CidrBlock": "10.5.1.0/24",
          "Tags":[
          { "Key": "Name", "Value":  "pubsubnet2" }
          ]
        }
      },  
      "privsubnet1": {
        "Type": "AWS::EC2::Subnet",
        "Properties": {
          "AvailabilityZone": 
          { "Ref": "AZ" }
          ,
          "VpcId": 
          { "Ref": "VPC" }
          ,
          "CidrBlock": "10.5.2.0/24",
          "Tags":[
          { "Key": "Name", "Value":  "privsubnet1" }
          ]
        }
      },
      "privsubnet2": {
        "Type": "AWS::EC2::Subnet",
        "Properties": {
          "AvailabilityZone": 
          { "Ref": "AZ" }
          ,
          "VpcId": 
          { "Ref": "VPC" }
          ,
          "CidrBlock": "10.5.3.0/24",
          "Tags":[
          { "Key": "Name", "Value":  "privsubnet2" }
          ]
        }
      },

      "natGW": {
        "Type": "AWS::EC2::NatGateway",
        "Properties": {
          "AllocationId": 
          { "Ref": "myEIP" }
          ,
          "ConnectivityType": "public",
          "SubnetId": 
          { "Ref": "pubsubnet2" }
          ,
          "Tags":[
            {"Key": "Name", "Value": "NewNatGW"}
          ]
        }
      },
      "myEIP": {
        "Type": "AWS::EC2::EIP",
        "Properties": {
          "Domain": 
          { "Ref": "VPC" },
          "Tags":[
          { "Key": "Name", "Value":  "EIP" }
          ]
        }
      } 
  }
}
